---
title: 'April: 10'
category: Daily
date: 2024-04-10 12:00:00
client: Self
unsplash: 1712251351568-1c56602c31aa
img: https://images.unsplash.com/photo-1712251351568-1c56602c31aa?crop=entropy&cs=srgb&fm=jpg&ixid=MnwzNjM5Nzd8MHwxfHJhbmRvbXx8fHx8fHx8fDE2ODE3NDg2ODY&ixlib=rb-4.0.3&q=85
description: |
    10th of April.
tags:
    - daily
---

import MDXJS from '../../components/MDXJS.astro';


<MDXJS>

## Notes

</MDXJS>


<MDXJS>

### 2024

<MDXJS>

#### Python

Today is going to be a heavy day of sneeks.
The big phat python that hopefully will not wrap around my server or neck.

Earlier, I went ahead and updated a decent amount of the `atlas` code base, preparing it for the future production environment, including test casing it on docker.

Yet, sadly, even the weird edge cases become a huge pain! But its been long over due, at least since last year, so it makes sense that I invest some heavy time into it.

</MDXJS>

---

<MDXJS>

#### FastAPI

To get started, we will add both the `fastapi` and the `uvicorn[standard]` to our standard poetry book, as they will provide the main entrance to our software stack.
Majority of the codebase will be within the `kbve_atlas`, with a `main.py` file located outside of it.
This `main.py` file will be the router that we use to handle all the python routes, including any micro-service that we might need down the line.
Under the current build, I am thinking of keeping a bunch of the services within an isolated python instance and then using our Rust API to handle the communication between them, ideally using a queue style system.

</MDXJS>

---

<MDXJS>

#### Main.py

Now the adventure of integrating the `main.py` with the FastAPI.

Here are the core functions we are going to migrate!

The first is the google/rss news feed:

```python
async def google_main():
    #rss_url = "https://news.google.com/rss?hl=en-US&gl=US&ceid=US:en"
    rss_url = "https://feeds.bbci.co.uk/news/world/rss.xml"
    rss_utility = RSSUtility(base_url=rss_url)

    try:

        soup = await rss_utility.fetch_and_parse_rss()
        rss_feed_model = await rss_utility.convert_to_model(soup)
        formatted_feed = RSSUtility.format_rss_feed(rss_feed_model)
        print(formatted_feed)
    finally:
        print("Done RSS")

    pass
```

While doing that change, I realized we could decor the poetry_main and coindesk_main.

```python

async def poetry_main():
    poetry_client = PoetryDBClient()
    try:
        random_poem = await poetry_client.get_random_poem()
        print(f"Title: {random_poem.title}\nAuthor: {random_poem.author}\n")
        print("\n".join(random_poem.lines))
        await poetry_client.close()
        print("\n Closed Session")
    except Exception as e:
        print(f"An error occurred: {e}")

        pass

async def coindesk_main():
    coindesk_client = CoinDeskClient()
    try:
        bitcoin_price = await coindesk_client.get_current_bitcoin_price()
        print(bitcoin_price)
    finally:
        await coindesk_client.close()

        pass


```

</MDXJS>

</MDXJS>