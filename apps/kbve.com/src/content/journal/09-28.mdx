---
title: 'September: 28th'
category: Daily
date: 2024-09-28 12:00:00
client: Self
unsplash: 1693550345119-ec1c806d74c2
img: https://images.unsplash.com/photo-1693550345119-ec1c806d74c2?crop=entropy&cs=srgb&fm=jpg&ixid=MnwzNjM5Nzd8MHwxfHJhbmRvbXx8fHx8fHx8fDE2ODE3NDg2ODY&ixlib=rb-4.0.3&q=85
description: September 28th. 
tags:
  - daily
---

import { Adsense, Tasks } from '@kbve/astropad';

## 2024

**File**

The issue that we are currently facing is the installation of a custom file into the container.

Quick commands to help debug this situation:

```shell

# Get Supabase Pods
kubectl get pods -n supabase

# Get Logs 
kubectl logs supabase-release-supabase-db-1-initdb-7djvz -n supabase

# Describe
kubectl describe pod supabase-release-supabase-db-1-initdb-2wwtr -n supabase

```

Okay to load the pgsodium key / shell, we can try to setup a sidecar with the information.
Actually since its the initDB, we can get away with using the environment because the whole container would get destroyed once its done with the init?
We would load the sidecar then through another deployment which would be the recovery? Hmm, there are ways to make this work.

Here is the pod template that we used to init the container:

```yaml 

  podTemplate:
    spec:
      initContainers:
        - name: pgsodium-getkey-init
          image: busybox
          command: ["/bin/sh", "-c", "kubectl get secret secret-pgsodium-key -n supabase -o jsonpath='{.data.pgsodium_key}' | base64 --decode > /pgsodium/keyfile"]
          volumeMounts:
            - name: pgsodium-keyfile-volume
              mountPath: /pgsodium
      containers:
        - name: main-container
          image: {{ .Values.db.image.repository }}:{{ .Values.db.image.tag }}
          volumeMounts:
            - name: pgsodium-keyfile-volume
              mountPath: /pgsodium
      volumes:
        - name: pgsodium-keyfile-volume
          emptyDir: {}

```

However, for now, we will just load the key in via the environmental variable.