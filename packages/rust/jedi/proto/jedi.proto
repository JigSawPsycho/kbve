syntax = "proto3";

package jedi;

enum PayloadFormat {
    PAYLOAD_UNKNOWN = 0;
    JSON = 1;
    FLEX = 2;
    PROTOBUF = 3;
    FLATBUFFER = 4;
}

enum MessageKind {
    UNKNOWN         = 0;
    KEY_UPDATE      = 1;
    ACTION          = 2;
    MESSAGE         = 4;
    DEBUG           = 8;
    ERROR           = 16;
    INFO            = 32;
    AUTH            = 64;
    HEARTBEAT       = 256;
    CONFIG_UPDATE   = 512;
}

message JediEnvelope {
    int32 version = 1;
    MessageKind kind = 2;
    PayloadFormat format = 3;
    bytes payload = 4;
}


message FlagEnvelope {
    int32 flag = 1;
    bytes payload = 2;
}

message FlexEnvelope {
    MessageKind kind = 1;
    bytes payload = 2;
}

message RawEnvelope {
    bytes key = 1;
    bytes payload = 2;
}

message JediMessage {
    oneof envelope {
        JediEnvelope hybrid = 1;
        FlexEnvelope flex = 2;
        RawEnvelope raw = 3;
        FlagEnvelope flag = 4;
    }
}