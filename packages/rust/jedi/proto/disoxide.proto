syntax = "proto3";

package disoxide;

message DiscordServer {
  // -- Server ID
  // ? server_id BIGINT PRIMARY KEY
  int64 server_id = 1;

  // -- Owner ID (linked to auth.users)
  // ? owner_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE
  string owner_id = 2;

  // -- Language Bitmask
  // ? lang INT DEFAULT 0
  int32 lang = 3;

  // -- Status Bitmask (public, nsfw, draft, etc.)
  // ? status INT DEFAULT 0
  int32 status = 4;

  // -- Invite Code
  // ? invite TEXT NOT NULL
  // CONSTRAINT ck_valid_invite_code CHECK (invite ~ '^[A-Za-z0-9-]{2,100}$')
  string invite = 5;

  // -- Server Name
  // ? name VARCHAR(101) NOT NULL
  // CONSTRAINT ck_name_combined CHECK (name ~ '^[\\p{L}\\p{N} _\\-,.!?]{2,100}$')
  string name = 6;

  // -- Summary (brief)
  // ? summary VARCHAR(200) NOT NULL
  // CONSTRAINT ck_summary_combined CHECK (summary ~ '^[\\p{L}\\p{N} _\\-,.!?]{2,200}$')
  string summary = 7;

  // -- Description (optional markdown)
  // ? description TEXT
  // CONSTRAINT ck_description_markdown CHECK (description ~ '^[\\p{L}\\p{N} _\\-,.!?*#~]{10,2000}$' OR description IS NULL)
  string description = 8;

  // -- Website URL (optional)
  // ? website TEXT
  // CONSTRAINT ck_website_url CHECK (website ~* '^(http://|https://)[a-zA-Z0-9./?=_-]+$' OR website IS NULL)
  string website = 9;

  // -- Logo URL
  // ? logo TEXT
  // CONSTRAINT ck_logo_url CHECK (logo ~* '^(http://|https://)[a-zA-Z0-9./?=_-]+$' OR logo IS NULL)
  string logo = 10;

  // -- Banner Image URL
  // ? banner TEXT
  // CONSTRAINT ck_banner_url CHECK (banner ~* '^(http://|https://)[a-zA-Z0-9./?=_-]+$' OR banner IS NULL)
  string banner = 11;

  // -- Video ID
  // ? video VARCHAR(32)
  // CONSTRAINT ck_video_id CHECK (video ~ '^[A-Za-z0-9_-]{1,32}$' OR video IS NULL)
  string video = 12;

  // -- Categories Bitmask (up to 50)
  // ? categories INT DEFAULT 0
  int32 categories = 13;

  // -- Updated Timestamp
  // ? updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
  string updated_at = 14;
}


message DiscordTag {
  // -- Tag ID (autogenerated)
  // ? tag_id BIGSERIAL PRIMARY KEY
  int64 tag_id = 1;

  // -- Tag Name
  // ? name TEXT NOT NULL UNIQUE CHECK (char_length(name) <= 32)
  // CONSTRAINT valid_tag_name CHECK (name ~ '^[a-z0-9-]+$')
  string name = 2;

  // -- Bitwise Status
  // ? status INT DEFAULT 0 NOT NULL
  int32 status = 3;
}
